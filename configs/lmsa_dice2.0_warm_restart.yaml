# Dice 2.0 + Warm Restarts + No Early Stop
# Goal: é‡æ–°æµ‹è¯•Dice 2.0ï¼Œè§£å†³LRè¡°å‡å’Œæ—©åœé—®é¢˜

experiment:
  name: lmsa_dice2.0_warm_restart
  description: "Dice 2.0 with warm restarts - fix early stop and LR decay issues"

model:
  name: microsegformer
  num_classes: 19
  use_lmsa: true
  dropout: 0.15

data:
  root: data
  batch_size: 32
  num_workers: 8
  val_split: 0.1

augmentation:
  horizontal_flip: 0.5
  rotation: 15
  scale_range: [0.9, 1.1]
  color_jitter:
    brightness: 0.2
    contrast: 0.2
    saturation: 0.1

loss:
  ce_weight: 1.0
  dice_weight: 2.0  # é‡æ–°æµ‹è¯•Dice 2.0
  use_focal: false
  use_class_weights: false

training:
  optimizer: AdamW
  learning_rate: 8e-4
  weight_decay: 1e-4
  scheduler: CosineAnnealingWarmRestarts  # ğŸ”¥ å‘¨æœŸæ€§é‡å¯LR
  scheduler_params:
    T_0: 25          # ç¬¬ä¸€æ¬¡é‡å¯25è½®
    T_mult: 2        # å‘¨æœŸç¿»å€
    eta_min: 1e-6  # 1e-6
  warmup_epochs: 5
  epochs: 200        # è®­ç»ƒè¶³å¤Ÿé•¿
  early_stopping_patience: 999  # ğŸ”¥ ä¸æ—©åœï¼
  max_grad_norm: 1.0
  use_amp: true

# ç†ç”±ï¼š
# 1. åŸDice 2.0åœ¨68è½®è¾¾åˆ°æœ€ä½³ï¼Œä½†98è½®æ—©åœå¯èƒ½è¿‡æ—©
# 2. Warm Restartsç»™å¤šæ¬¡æ”¶æ•›æœºä¼š
# 3. ä¸æ—©åœï¼Œè®©æ¨¡å‹å……åˆ†è®­ç»ƒ200è½®
# 4. å¯èƒ½Dice 2.0é…åˆæ­£ç¡®çš„LRç­–ç•¥ä¼šæ›´å¥½
